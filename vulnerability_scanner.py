import port_scanner

targets_ip = input('[+] Enter Target to scan for vulnerable open ports: ')
port_number = int(input('[+] Enter Amount of ports you want to scan (starting from zero): '))
vul_file = input('[+] Enter Path to the file with vulnerable software: ')
print('\n')

ps = port_scanner.PortScan(targets_ip, port_number)
ps.scan()

with open(vul_file, 'r') as file:
    count = 0
    for banner in ps.banners:
        file.seek(0)  # return to the beginning for a new search

        for line in file.readlines():
            if line.strip() in banner:
                print('[+] Vulnerable Banner: ' + banner + " on Port: " + str(ps.open_ports[count]))

        count += 1

